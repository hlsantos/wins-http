function SoundManager(d,f){var a=this;this.version="V2.0b.20070123";this.url=d||"/public/js/soundmanager2.swf";this.debugMode=!1;this.useConsole=!0;this.consoleOnly=!1;this.defaultOptions={autoLoad:!1,stream:!0,autoPlay:!1,onid3:null,onload:null,whileloading:null,onplay:null,whileplaying:null,onstop:null,onfinish:null,onbeforefinish:null,onbeforefinishtime:5E3,onbeforefinishcomplete:null,onjustbeforefinish:null,onjustbeforefinishtime:200,multiShot:!0,pan:0,volume:100};this.allowPolling=!0;this.enabled=
!1;this.o=null;this.id=f||"sm2movie";this.oMC=null;this.sounds=[];this.soundIDs=[];this.isIE=navigator.userAgent.match(/MSIE/);this.isSafari=navigator.userAgent.match(/safari/i);this.debugID="soundmanager-debug";this._debugOpen=!0;this._disabled=this._didInit=this._appendSuccess=this._didAppend=!1;this._hasConsole="undefined"!=typeof console&&"undefined"!=typeof console.log;this._debugLevels=!a.isSafari?["debug","info","warn","error"]:["log","log","log","log"];this.getMovie=function(b){return a.isIE?
window[b]:a.isSafari?document[b+"-embed"]:document.getElementById(b+"-embed")};this.loadFromXML=function(b){try{a.o._loadFromXML(b)}catch(c){return a._failSafely(),!0}};this.createSound=function(b){if(!a._didInit)throw Error("soundManager.createSound(): Not loaded yet - wait for soundManager.onload() before calling sound-related methods");2==arguments.length&&(b={id:arguments[0],url:arguments[1]});var c=a._mergeObjects(b);a._writeDebug('soundManager.createSound(): "<a href="#" onclick="soundManager.play(\''+
c.id+'\');return false" title="play this sound">'+c.id+'</a>" ('+c.url+")",1);if(a._idCheck(c.id,!0))return a._writeDebug("sound "+c.id+" already defined - exiting",2),!1;a.sounds[c.id]=new SMSound(a,c);a.soundIDs[a.soundIDs.length]=c.id;try{a.o._createSound(c.id,c.onjustbeforefinishtime)}catch(d){return a._failSafely(),!0}(c.autoLoad||c.autoPlay)&&a.sounds[c.id].load(c);c.autoPlay&&(a.sounds[c.id].playState=1)};this.load=function(b,c){if(!a._idCheck(b))return!1;a.sounds[b].load(c)};this.unload=function(b){if(!a._idCheck(b))return!1;
a.sounds[b].unload()};this.start=this.play=function(b,c){if(!a._idCheck(b))if("Object"!=typeof c&&(c={url:c}),c&&c.url)a._writeDebug('soundController.play(): attempting to create "'+b+'"',1),c.id=b,a.createSound(c);else return!1;a.sounds[b].play(c)};this.setPosition=function(b,c){if(!a._idCheck(b))return!1;a.sounds[b].setPosition(c)};this.stop=function(b){if(!a._idCheck(b))return!1;a._writeDebug("soundManager.stop("+b+")",1);a.sounds[b].stop()};this.stopAll=function(){for(var b in a.sounds)b instanceof
SMSound&&b.stop()};this.pause=function(b){if(!a._idCheck(b))return!1;a.sounds[b].pause()};this.resume=function(b){if(!a._idCheck(b))return!1;a.sounds[b].resume()};this.togglePause=function(b){if(!a._idCheck(b))return!1;a.sounds[b].togglePause()};this.setPan=function(b,c){if(!a._idCheck(b))return!1;a.sounds[b].setPan(c)};this.setVolume=function(b,c){if(!a._idCheck(b))return!1;a.sounds[b].setVolume(c)};this.setPolling=function(b){if(!a.o||!a.allowPolling)return!1;a._writeDebug("soundManager.setPolling("+
b+")");a.o._setPolling(b)};this.disable=function(){if(a._disabled)return!1;a._disabled=!0;a._writeDebug("soundManager.disable(): Disabling all functions - future calls will return false.",1);for(var b=a.soundIDs.length;b--;)a._disableObject(a.sounds[a.soundIDs[b]]);a.initComplete();a._disableObject(a)};this.getSoundById=function(b,c){if(!b)throw Error("SoundManager.getSoundById(): sID is null/undefined");var d=a.sounds[b];!d&&!c&&a._writeDebug('"'+b+'" is an invalid sound ID.',2);return d};this.onload=
function(){soundManager._writeDebug("<em>Warning</em>: soundManager.onload() is undefined.",2)};this.onerror=function(){};this._idCheck=this.getSoundById;this._disableObject=function(a){for(var c in a)"function"==typeof a[c]&&(a[c]=function(){return!1});c=null};this._failSafely=function(){a._disabled||(a._writeDebug('soundManager: JS-&gt;Flash communication failed. Possible causes: flash/browser security restrictions (<a href="http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html" title="You may need to whitelist this location/domain eg. file:///C:/ or C:/ or mysite.com, or set ALWAYS ALLOW under the Flash Player Global Security Settings page. Note that this seems to apply only to file system viewing.">view/edit</a>), insufficient browser/plugin support, or .swf not found',
2),a._writeDebug("Verify that the movie path of <em>"+a.url+'</em> is correct (<a href="'+a.url+'" title="If you get a 404/not found, fix it!">test link</a>)',1),a._didAppend&&!document.domain&&(a._writeDebug('Loading from local file system? (document.domain appears to be null, this URL path may need to be added to \'trusted locations\' in <a href="http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html" title="Flash Player Global Security Settings">FPGSS</a>)',
1),a._writeDebug('Possible security/domain restrictions (<a href="http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html" title="You may need to whitelist this location/domain eg. file:///C:/ or C:/ or mysite.com, or set ALWAYS ALLOW under the Flash Player Global Security Settings page. Note that this seems to apply only to file system viewing.">view/edit</a>), should work when served by http on same domain',1)),a.disable())};this._createMovie=function(b,c){if(a._didAppend&&
a._appendSuccess)return!1;window.location.href.indexOf("debug=1")+1&&(a.debugMode=!0);a._didAppend=!0;var d=['<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+window.location.protocol+'//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" width="16" height="16" id="'+b+'"><param name="movie" value="'+c+'"><param name="quality" value="high"><param name="allowScriptAccess" value="always" /></object>','<embed name="'+b+'-embed" id="'+b+'-embed" src="'+
c+'" width="1" height="1" quality="high" allowScriptAccess="always" pluginspage="'+window.location.protocol+'//www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash"></embed>'],e='<div id="'+a.debugID+'-toggle" style="position:fixed;_position:absolute;right:0px;bottom:0px;_top:0px;width:1.2em;height:1.2em;line-height:1.2em;margin:2px;padding:0px;text-align:center;border:1px solid #999;cursor:pointer;background:#fff;color:#333;z-index:706" title="Toggle SM2 debug console" onclick="soundManager._toggleDebug()">-</div>';
a.debugMode&&(!a._hasConsole||!a.useConsole||a.useConsole&&a._hasConsole&&!a.consoleOnly)&&document.getElementById(a.debugID);var g=document.body?document.body:document.getElementsByTagName("div")[0];if(g){a.oMC=document.createElement("div");a.oMC.className="movieContainer";a.oMC.style.position="absolute";a.oMC.style.left="-256px";a.oMC.style.width="1px";a.oMC.style.height="1px";try{g.appendChild(a.oMC),a.oMC.innerHTML=d[a.isIE?0:1],a._appendSuccess=!0}catch(f){throw Error("soundManager._createMovie(): appendChild/innerHTML set failed. Serving application/xhtml+xml MIME type? Browser may be enforcing strict rules, not allowing write to innerHTML. (PS: If so, this means your commitment to XML validation is going to break stuff now, because this part isn't finished yet. ;))");
}if(!document.getElementById(a.debugID)&&(!a._hasConsole||!a.useConsole||a.useConsole&&a._hasConsole&&!a.consoleOnly)){d=document.createElement("div");d.id=a.debugID;d.style.display=a.debugMode?"block":"none";if(a.debugMode)try{var h=document.createElement("div");g.appendChild(h);h.innerHTML=e}catch(i){throw Error("soundManager._createMovie(): appendChild/innerHTML set failed. Serving application/xhtml+xml MIME type? Browser may be enforcing strict rules, not allowing write to innerHTML. (PS: If so, this means your commitment to XML validation is going to break stuff now, because this part isn't finished yet. ;))");
}g.appendChild(d)}}a._writeDebug("-- SoundManager 2 Version "+a.version.substr(1)+" --",1);a._writeDebug('soundManager._createMovie(): trying to load <a href="'+c+'" title="Test this link (404=bad)">'+c+"</a>",1)};this._writeDebug=function(b,c){if(!a.debugMode)return!1;if(a._hasConsole&&a.useConsole&&(console[a._debugLevels[c]||"log"](b),a.useConsoleOnly))return!0;try{var d=document.getElementById("soundmanager-debug");if(!d)return!1;var e=document.createElement("div");e.innerHTML=b;d.insertBefore(e,
d.firstChild)}catch(g){}};this._writeDebugAlert=function(a){alert(a)};window.location.href.indexOf("debug=alert")+1&&(a.debugMode=!0,a._writeDebug=a._writeDebugAlert);this._toggleDebug=function(){var b=document.getElementById(a.debugID),c=document.getElementById(a.debugID+"-toggle");if(!b)return false;if(a._debugOpen){c.innerHTML="+";b.style.display="none"}else{c.innerHTML="-";b.style.display="block"}a._debugOpen=!a._debugOpen};this._debug=function(){a._writeDebug("soundManager._debug(): sounds by id/url:",
0);for(var b=0,c=a.soundIDs.length;b<c;b++)a._writeDebug(a.sounds[a.soundIDs[b]].sID+" | "+a.sounds[a.soundIDs[b]].url,0)};this._mergeObjects=function(b,c){var d=typeof c=="undefined"?a.defaultOptions:c,e;for(e in d)typeof b[e]=="undefined"&&(b[e]=d[e]);return b};this.createMovie=function(b){if(b)a.url=b;a._initMovie()};this._initMovie=function(){if(a.o)return false;a.o=a.getMovie(a.id);if(!a.o){a._createMovie(a.id,a.url);a.o=a.getMovie(a.id)}a.o&&a._writeDebug("soundManager._initMovie(): Got "+a.o.nodeName+
" element ("+(a._didAppend?"created via JS":"static HTML")+")",1)};this.initComplete=function(){if(a._didInit)return false;a._didInit=true;a._writeDebug("-- SoundManager 2 "+(a._disabled?"failed to load":"loaded")+" ("+(a._disabled?"security/load error":"OK")+") --",1);if(a._disabled){a._writeDebug("soundManager.initComplete(): calling soundManager.onerror()",1);a.onerror.apply(window);return false}a._writeDebug("soundManager.initComplete(): calling soundManager.onload()",1);try{a.onload.apply(window)}catch(b){a._writeDebug("soundManager.onload() threw an exception: "+
b.message,2);throw b;}a._writeDebug("soundManager.onload() complete",1)};this.init=function(){window.removeEventListener?window.removeEventListener("load",a.beginInit,false):window.detachEvent&&window.detachEvent("onload",a.beginInit);try{a.o._externalInterfaceTest();a._writeDebug("Flash ExternalInterface call (JS -&gt; Flash) succeeded.",1);a.allowPolling||a._writeDebug("Polling (whileloading/whileplaying support) is disabled.",1);a.setPolling(true);a.enabled=true}catch(b){a._failSafely();a.initComplete();
return false}a.initComplete()};this.beginDelayedInit=function(){setTimeout(a.beginInit,200)};this.beginInit=function(){a.createMovie();a._initMovie();setTimeout(a.init,1E3)};this.destruct=function(){if(a.isSafari)for(var b=a.soundIDs.length;b--;)a.sounds[a.soundIDs[b]].readyState==1&&a.sounds[a.soundIDs[b]].unload();a.disable()}}
function SMSound(d,f){var a=this;this.sID=f.id;this.url=f.url;this.options=d._mergeObjects(f);this.id3={};a.resetProperties=function(){a.bytesLoaded=null;a.bytesTotal=null;a.position=null;a.duration=null;a.durationEstimate=null;a.loaded=!1;a.loadSuccess=null;a.playState=0;a.paused=!1;a.readyState=0;a.didBeforeFinish=!1;a.didJustBeforeFinish=!1};a.resetProperties();this.load=function(b){a.loaded=!1;a.loadSuccess=null;a.readyState=1;a.playState=b.autoPlay||!1;b=d._mergeObjects(b);"undefined"==typeof b.url&&
(b.url=a.url);try{d._writeDebug("loading "+b.url,1),d.o._load(a.sID,b.url,b.stream,b.autoPlay,b.whileloading?1:0)}catch(c){d._writeDebug("SMSound().load(): JS-&gt;Flash communication failed.",2)}};this.unload=function(){d._writeDebug("SMSound().unload()");a.setPosition(0);d.o._unload(a.sID,"data/null.mp3");a.resetProperties()};this.start=this.play=function(b){b||(b={});b.onfinish&&(a.options.onfinish=b.onfinish);b.onbeforefinish&&(a.options.onbeforefinish=b.onbeforefinish);b.onjustbeforefinish&&(a.options.onjustbeforefinish=
b.onjustbeforefinish);b=d._mergeObjects(b);if(1==a.playState)if(b.multiShot)d._writeDebug('SMSound.play(): "'+a.sID+'" already playing (multi-shot)',1);else return d._writeDebug('SMSound.play(): "'+a.sID+'" already playing? (one-shot)',1),!1;if(a.loaded)d._writeDebug('SMSound.play(): "'+a.sID+'"');else if(0==a.readyState)d._writeDebug('SMSound.play(): .play() before load request. Attempting to load "'+a.sID+'"',1),b.stream=!0,b.autoPlay=!0,a.load(b);else{if(2==a.readyState)return d._writeDebug('SMSound.play(): Could not load "'+
a.sID+'" - exiting',2),!1;d._writeDebug('SMSound.play(): "'+a.sID+'" is loading - attempting to play..',1)}a.paused?a.resume():(a.playState=1,a.position=b.offset||0,b.onplay&&b.onplay.apply(a),a.setVolume(b.volume),a.setPan(b.pan),b.autoPlay||(d._writeDebug("starting sound "+a.sID),d.o._start(a.sID,b.loop||1,a.position)))};this.stop=function(){1==a.playState&&(a.playState=0,a.paused=!1,d.defaultOptions.onstop&&d.defaultOptions.onstop.apply(a),d.o._stop(a.sID))};this.setPosition=function(b){d.o._setPosition(a.sID,
b/1E3,a.paused||!a.playState)};this.pause=function(){if(a.paused)return!1;d._writeDebug("SMSound.pause()");a.paused=!0;d.o._pause(a.sID)};this.resume=function(){if(!a.paused)return!1;d._writeDebug("SMSound.resume()");a.paused=!1;d.o._pause(a.sID)};this.togglePause=function(){d._writeDebug("SMSound.togglePause()");if(!a.playState)return a.play({offset:a.position/1E3}),!1;a.paused?(d._writeDebug("SMSound.togglePause(): resuming.."),a.resume()):(d._writeDebug("SMSound.togglePause(): pausing.."),a.pause())};
this.setPan=function(b){"undefined"==typeof b&&(b=0);d.o._setPan(a.sID,b);a.options.pan=b};this.setVolume=function(b){"undefined"==typeof b&&(b=100);d.o._setVolume(a.sID,b);a.options.volume=b};this._whileloading=function(b,c,d){a.bytesLoaded=b;a.bytesTotal=c;a.duration=d;a.durationEstimate=parseInt(a.bytesTotal/a.bytesLoaded*a.duration);3!=a.readyState&&a.options.whileloading&&a.options.whileloading.apply(a)};this._onid3=function(b,c){d._writeDebug('SMSound()._onid3(): "'+this.sID+'" ID3 data received.');
for(var f=[],e=0,g=b.length;e<g;e++)f[b[e]]=c[e];a.id3=d._mergeObjects(a.id3,f);a.options.onid3&&a.options.onid3.apply(a)};this._whileplaying=function(b){if(isNaN(b)||null==b)return!1;a.position=b;1==a.playState&&(a.options.whileplaying&&a.options.whileplaying.apply(a),a.loaded&&(a.options.onbeforefinish&&a.options.onbeforefinishtime&&!a.didBeforeFinish&&a.duration-a.position<=a.options.onbeforefinishtime)&&(d._writeDebug("duration-position &lt;= onbeforefinishtime: "+a.duration+" - "+a.position+
" &lt= "+a.options.onbeforefinishtime+" ("+(a.duration-a.position)+")"),a._onbeforefinish()))};this._onload=function(b){b=1==b?!0:!1;d._writeDebug('SMSound._onload(): "'+a.sID+'"'+(b?" loaded.":' failed to load (or loaded from cache - weird bug) - [<a href="'+a.url+'">test URL</a>]'));a.loaded=b;a.loadSuccess=b;a.readyState=b?3:2;a.options.onload&&a.options.onload.apply(a)};this._onbeforefinish=function(){a.didBeforeFinish||(a.didBeforeFinish=!0,a.options.onbeforefinish&&a.options.onbeforefinish.apply(a))};
this._onjustbeforefinish=function(){a.didJustBeforeFinish||(a.didJustBeforeFinish=!0,soundManager._writeDebug("SMSound._onjustbeforefinish()"),a.options.onjustbeforefinish&&a.options.onjustbeforefinish.apply(a))};this._onfinish=function(){d._writeDebug('SMSound._onfinish(): "'+a.sID+'" finished playing');a.playState=0;a.paused=!1;a.options.onfinish&&a.options.onfinish.apply(a);a.options.onbeforefinishcomplete&&a.options.onbeforefinishcomplete.apply(a);a.setPosition(0);a.didBeforeFinish=!1;a.didJustBeforeFinish=
!1}}var soundManager=new SoundManager;window.addEventListener?(window.addEventListener("load",soundManager.beginDelayedInit,!1),window.addEventListener("beforeunload",soundManager.destruct,!1)):window.attachEvent?(window.attachEvent("onload",soundManager.beginInit),window.attachEvent("beforeunload",soundManager.destruct)):(soundManager.onerror(),soundManager.disable());
